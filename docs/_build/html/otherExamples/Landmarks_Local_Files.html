
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Landmarks (using Local Files) &#8212; cityImage 0.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'otherExamples/Landmarks_Local_Files';</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">cityImage 0.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/userGuide.html">
                        User Guide
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../notebooks/userGuide.html">
                        User Guide
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Landmarks...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Landmarks-(using-Local-Files)">
<h1>Landmarks (using Local Files)<a class="headerlink" href="#Landmarks-(using-Local-Files)" title="Link to this heading">#</a></h1>
<p>Four scores are here computed to extract computation landmarks: structural, visual, cultural, pragmatic. The user has to provide at least an attribute shapefile containing the height attribute (the only mandatory field). See below for further instructions on the data sources.</p>
<p>The user can also provide, seaprately, information about cultural/historical landmarks (e.g. position of listed important buildings); see <em>3 - Cultural component</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span><span class="o">,</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span><span class="o">,</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">LineString</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:20.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>

<span class="kn">import</span> <span class="nn">cityImage</span> <span class="k">as</span> <span class="nn">ci</span>
</pre></div>
</div>
</div>
<section id="Preparation">
<h2>Preparation<a class="headerlink" href="#Preparation" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city_name</span> <span class="o">=</span> <span class="s1">&#39;Barcelona&#39;</span>
<span class="n">epsg</span> <span class="o">=</span> <span class="mi">2062</span>
<span class="n">crs</span> <span class="o">=</span> <span class="s1">&#39;EPSG:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>
<span class="n">input_path</span> <span class="o">=</span> <span class="s1">&#39;../data/&#39;</span><span class="o">+</span><span class="n">city_name</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="s1">&#39;../output/&#39;</span><span class="o">+</span><span class="n">city_name</span>
</pre></div>
</div>
</div>
<section id="Obstructions">
<h3>Obstructions<a class="headerlink" href="#Obstructions" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obstructions</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">input_path</span><span class="o">+</span><span class="s1">&#39;_buildings.gpkg&#39;</span><span class="p">)</span>
<span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obstructions</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span>
<span class="n">obstructions</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">obstructions</span><span class="o">.</span><span class="n">area</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)]</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">[</span><span class="o">~</span><span class="n">obstructions</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="n">obstructions</span><span class="p">[</span><span class="s2">&quot;buildingID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obstructions</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Buildings">
<h3>Buildings<a class="headerlink" href="#Buildings" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reading the street network</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">output_path</span><span class="o">+</span><span class="s1">&#39;_nodes.gpkg&#39;</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">output_path</span><span class="o">+</span><span class="s1">&#39;_edges.gpkg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings</span> <span class="o">=</span> <span class="n">obstructions</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">convex_hull</span> <span class="o">=</span> <span class="n">edges</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span><span class="o">.</span><span class="n">convex_hull</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="o">.</span><span class="n">centroid</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">buildings</span><span class="p">[</span><span class="n">buildings</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">buffer</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p><strong>Visualisation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">plot_gdf</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">scheme</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="n">black_background</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
                  <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                  <span class="n">title</span> <span class="o">=</span> <span class="n">city_name</span><span class="o">+</span><span class="s1">&#39;: Buildings vs Obstructions&#39;</span><span class="p">,</span>
                  <span class="n">base_map_gdf</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">,</span> <span class="n">base_map_color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                  <span class="n">base_map_alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">base_map_zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/otherExamples_Landmarks_Local_Files_10_0.png" src="../_images/otherExamples_Landmarks_Local_Files_10_0.png" />
</div>
</div>
</section>
</section>
<section id="Structural-component">
<h2>Structural component<a class="headerlink" href="#Structural-component" title="Link to this heading">#</a></h2>
<p>It considers: * The area of the building. * Its distance from the road. * The number of adjacent buildings, within the given <code class="docutils literal notranslate"><span class="pre">neighbours_radius</span></code>, around it. * A measure of 2d advance visibility, expanded till a maximum distance from the center of the building on the basis of the <code class="docutils literal notranslate"><span class="pre">advance_vis_expansion_distance</span></code> parameter.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The &#39;buffer&#39; parameter indicates distance within the algorithms look for neighbouring buildings</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">structural_score</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">obstructions</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">advance_vis_expansion_distance</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                                <span class="n">neighbours_radius</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Visual-component">
<h2>Visual component<a class="headerlink" href="#Visual-component" title="Link to this heading">#</a></h2>
<section id="Sight-Lines-Construction">
<h3>Sight Lines Construction<a class="headerlink" href="#Sight-Lines-Construction" title="Link to this heading">#</a></h3>
<p>This is a computationally expensive step that may takes hours (in particular the intervisibility check that verifies whether the sigh lines are actually visible or not). One way to reduce it is to cluster nodes and therefore generate a lower number of sight lines. The function takes two parameters, besides the observer and the targets GeoDataFrames: * <code class="docutils literal notranslate"><span class="pre">distance_along</span></code>: It regulates the interval along the exterior of each building for which a point is identified and used as a target point. If
the exterior of the building is shorter than the parameter, at least one point is identified. * <code class="docutils literal notranslate"><span class="pre">distance_min_observer_target</span></code>: The function only computes sight lines for nodes and buildings whose distance is higher than this parameter.</p>
<p><strong>One can choose between two methods to compute the 3dvis score:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">combined</span></code> –&gt; It computes a combined score that takes into account, per each building: * The number of sight lines towards it. * Their average length. * The maximum lenght amongst them.</p>
<p><code class="docutils literal notranslate"><span class="pre">longest</span></code> –&gt; It just uses the longest sight line’s length as a score</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sight_lines</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">compute_3d_sight_lines</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">distance_along</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
                                                         <span class="n">distance_min_observer_target</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings</span><span class="p">,</span> <span class="n">sight_lines</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">visibility_score</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">sight_lines</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;longest&#39;</span><span class="p">)</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[28], line 1</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> sight_lines <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">ci</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">compute_3d_sight_lines</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">nodes</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">buildings</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">distance_along</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">300</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">      2</span> <span class="ansi-yellow-bg">                                                         </span><span class="ansi-yellow-bg">distance_min_observer_target</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">300</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">      3</span> buildings, sight_lines <span style="color: rgb(98,98,98)">=</span> ci<span style="color: rgb(98,98,98)">.</span>visibility_score(buildings, sight_lines, method <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">longest</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">      4</span> buildings<span style="color: rgb(98,98,98)">.</span>head()

File <span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\miniconda3\envs\cityImage\Lib\site-packages\cityImage\visibility.py:144</span>, in <span class="ansi-cyan-fg">compute_3d_sight_lines</span><span class="ansi-blue-intense-fg ansi-bold">(nodes_gdf, buildings_gdf, distance_along, distance_min_observer_target)</span>
<span class="ansi-green-fg">    141</span> sight_lines<span style="color: rgb(98,98,98)">.</span>reset_index(drop <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, inplace <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>)
<span class="ansi-green-fg">    143</span> <span style="color: rgb(95,135,135)"># create pyvista 3d objects for buildings</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 144</span> buildings_gdf[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">building_3d</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">polygon_2d_to_3d</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">geo</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">base</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">height</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">for</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">geo</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">base</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">height</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(175,0,255)">in</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">zip</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">buildings_gdf</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">geometry</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">buildings_gdf</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">base</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">buildings_gdf</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">height</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">]</span>
<span class="ansi-green-fg">    145</span> <span style="color: rgb(95,135,135)"># extract tuples for starting and target points of the sight lines</span>
<span class="ansi-green-fg">    146</span> sight_lines[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">start</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> [[observer<span style="color: rgb(98,98,98)">.</span>x, observer<span style="color: rgb(98,98,98)">.</span>y, observer<span style="color: rgb(98,98,98)">.</span>z] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> observer <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> sight_lines<span style="color: rgb(98,98,98)">.</span>observer]

File <span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\miniconda3\envs\cityImage\Lib\site-packages\cityImage\visibility.py:144</span>, in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-intense-fg ansi-bold">(.0)</span>
<span class="ansi-green-fg">    141</span> sight_lines<span style="color: rgb(98,98,98)">.</span>reset_index(drop <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, inplace <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>)
<span class="ansi-green-fg">    143</span> <span style="color: rgb(95,135,135)"># create pyvista 3d objects for buildings</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 144</span> buildings_gdf[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">building_3d</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> [<span class="ansi-yellow-bg">polygon_2d_to_3d</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">geo</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">base</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">height</span><span class="ansi-yellow-bg">)</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> geo,base, height <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">zip</span>(buildings_gdf[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">geometry</span><span style="color: rgb(175,0,0)">&#39;</span>], buildings_gdf[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">base</span><span style="color: rgb(175,0,0)">&#39;</span>], buildings_gdf[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">height</span><span style="color: rgb(175,0,0)">&#39;</span>])]
<span class="ansi-green-fg">    145</span> <span style="color: rgb(95,135,135)"># extract tuples for starting and target points of the sight lines</span>
<span class="ansi-green-fg">    146</span> sight_lines[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">start</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> [[observer<span style="color: rgb(98,98,98)">.</span>x, observer<span style="color: rgb(98,98,98)">.</span>y, observer<span style="color: rgb(98,98,98)">.</span>z] <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> observer <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> sight_lines<span style="color: rgb(98,98,98)">.</span>observer]

File <span class="ansi-green-intense-fg ansi-bold">~\AppData\Local\miniconda3\envs\cityImage\Lib\site-packages\cityImage\utilities.py:566</span>, in <span class="ansi-cyan-fg">polygon_2d_to_3d</span><span class="ansi-blue-intense-fg ansi-bold">(building_polygon, base, height)</span>
<span class="ansi-green-fg">    563</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    564</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> xy[::<span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span>]
<span class="ansi-green-intense-fg ansi-bold">--&gt; 566</span> poly_points <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">building_polygon</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">exterior</span><span style="color: rgb(98,98,98)">.</span>coords
<span class="ansi-green-fg">    568</span> <span style="color: rgb(95,135,135)"># Reorient the coordinates of the polygon</span>
<span class="ansi-green-fg">    569</span> xy <span style="color: rgb(98,98,98)">=</span> reorient_coords(poly_points)

<span class="ansi-red-intense-fg ansi-bold">AttributeError</span>: &#39;MultiPolygon&#39; object has no attribute &#39;exterior&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">plot_gdf</span><span class="p">(</span><span class="n">sight_lines</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.07</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">base_map_gdf</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">,</span> <span class="n">base_map_color</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
            <span class="n">geometry_size</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">base_map_alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/otherExamples_Landmarks_Local_Files_18_0.png" src="../_images/otherExamples_Landmarks_Local_Files_18_0.png" />
</div>
</div>
</section>
</section>
<section id="Cultural-component">
<h2>Cultural component<a class="headerlink" href="#Cultural-component" title="Link to this heading">#</a></h2>
<p>It measures the symbolic/cultural value of each building. <em>This part is case-study specific, see other examples for generalizable methods</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cultural_elements</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/otherSources/&#39;</span><span class="o">+</span><span class="n">city_name</span><span class="o">+</span><span class="s1">&#39;_historic_landmarks.shp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">cultural_score</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">cultural_elements</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Pragmatic-component">
<h2>Pragmatic component<a class="headerlink" href="#Pragmatic-component" title="Link to this heading">#</a></h2>
<p>Before computing the pragmatic score, the <code class="docutils literal notranslate"><span class="pre">land_use_raw</span></code> raw field is categorised into more granular categories. One can fill in the following categories to accomodate descriptors not accounted for. Run the 1st and the 2nd cells below so to check which descriptors in <code class="docutils literal notranslate"><span class="pre">land_use_raw</span></code> are not inclued at the moment in the macro categories.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># introducing classifications and possible entries</span>

<span class="n">adult_entertainment</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;brothel&#39;</span><span class="p">,</span><span class="s1">&#39;casino&#39;</span><span class="p">,</span> <span class="s1">&#39;swingerclub&#39;</span><span class="p">,</span> <span class="s1">&#39;stripclub&#39;</span><span class="p">,</span> <span class="s1">&#39;nightclub&#39;</span><span class="p">,</span> <span class="s1">&#39;gambling&#39;</span><span class="p">]</span>

<span class="n">agriculture</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;shed&#39;</span><span class="p">,</span> <span class="s1">&#39;silo&#39;</span><span class="p">,</span> <span class="s1">&#39;greenhouse&#39;</span><span class="p">,</span> <span class="s1">&#39;stable&#39;</span><span class="p">,</span> <span class="s1">&#39;agricultural and forestry&#39;</span><span class="p">,</span>  <span class="s1">&#39;greenhouse (botany)&#39;</span><span class="p">,</span>
               <span class="s1">&#39;building in the botanical garden&#39;</span><span class="p">]</span>

<span class="n">attractions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;attractions&#39;</span><span class="p">,</span>   <span class="s1">&#39;attraction&#39;</span><span class="p">,</span><span class="s1">&#39;aquarium&#39;</span><span class="p">,</span> <span class="s1">&#39;monument&#39;</span><span class="p">,</span>  <span class="s1">&#39;gatehouse&#39;</span><span class="p">,</span> <span class="s1">&#39;terrace&#39;</span><span class="p">,</span> <span class="s1">&#39;tower&#39;</span><span class="p">,</span> <span class="s1">&#39;attraction and leisure&#39;</span><span class="p">,</span>
               <span class="s1">&#39;information&#39;</span><span class="p">,</span> <span class="s1">&#39;viewpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;tourist information center&#39;</span><span class="p">,</span> <span class="s1">&#39;recreation and amusement park&#39;</span><span class="p">,</span>  <span class="s1">&#39;zoo&#39;</span><span class="p">,</span>
               <span class="s1">&#39;exhibition hall, trade hall&#39;</span><span class="p">,</span> <span class="s1">&#39;boathouse&#39;</span><span class="p">,</span> <span class="s1">&#39;bath house, thermal baths&#39;</span><span class="p">,</span> <span class="s1">&#39;entertainment hall&#39;</span><span class="p">,</span> <span class="s1">&#39;sauna&#39;</span><span class="p">]</span>

<span class="n">business_services</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bank&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">,</span><span class="s1">&#39;offices&#39;</span><span class="p">,</span> <span class="s1">&#39;foundation&#39;</span><span class="p">,</span> <span class="s1">&#39;office&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;bureau_de_change&#39;</span><span class="p">,</span> <span class="s1">&#39;post_office&#39;</span><span class="p">,</span>
              <span class="s1">&#39;post_office;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;coworking_space&#39;</span><span class="p">,</span> <span class="s1">&#39;conference_centre&#39;</span><span class="p">,</span>  <span class="s1">&#39;trade and services&#39;</span><span class="p">,</span> <span class="s1">&#39;trade and services building&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;customs office&#39;</span><span class="p">,</span> <span class="s1">&#39;insurance&#39;</span><span class="p">,</span> <span class="s1">&#39;tax_office&#39;</span><span class="p">,</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="s1">&#39;administrative building&#39;</span><span class="p">,</span>  <span class="s1">&#39;facility building&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;residential building with trade and services&#39;</span><span class="p">,</span> <span class="s1">&#39;data_center&#39;</span><span class="p">,</span> <span class="s1">&#39;tax office&#39;</span><span class="p">]</span>

<span class="n">commercial</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;commercial&#39;</span><span class="p">,</span>  <span class="s1">&#39;retail&#39;</span><span class="p">,</span> <span class="s1">&#39;pharmacy&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial;educa&#39;</span><span class="p">,</span> <span class="s1">&#39;shop&#39;</span><span class="p">,</span> <span class="s1">&#39;supermarket&#39;</span><span class="p">,</span> <span class="s1">&#39;books&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial services&#39;</span><span class="p">,</span>
              <span class="s1">&#39;commercial land&#39;</span><span class="p">,</span> <span class="s1">&#39;car_wash&#39;</span><span class="p">,</span> <span class="s1">&#39;internet_cafe&#39;</span><span class="p">,</span> <span class="s1">&#39;driving_school&#39;</span><span class="p">,</span> <span class="s1">&#39;marketplace&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel&#39;</span><span class="p">,</span> <span class="s1">&#39;car_sharing&#39;</span><span class="p">,</span>
              <span class="s1">&#39;commercial and industry buidling&#39;</span><span class="p">,</span>  <span class="s1">&#39;crematorium&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial building&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial and industry building&#39;</span><span class="p">,</span>
              <span class="s1">&#39;commercial building to traffic facilities (general)&#39;</span><span class="p">,</span> <span class="s1">&#39;funeral parlor&#39;</span><span class="p">,</span> <span class="s1">&#39;gas station&#39;</span><span class="p">,</span> <span class="s1">&#39;car wash&#39;</span><span class="p">,</span>
              <span class="s1">&#39;pumping station&#39;</span><span class="p">,</span><span class="s1">&#39;boat_rental&#39;</span><span class="p">,</span> <span class="s1">&#39;boat_sharing&#39;</span><span class="p">,</span>  <span class="s1">&#39;bicycle_rental&#39;</span><span class="p">,</span> <span class="s1">&#39;car_rental&#39;</span><span class="p">,</span> <span class="s1">&#39;dive_centre&#39;</span><span class="p">]</span>

<span class="n">culture</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;club_house&#39;</span><span class="p">,</span><span class="s1">&#39;gallery&#39;</span><span class="p">,</span> <span class="s1">&#39;arts_centre&#39;</span><span class="p">,</span><span class="s1">&#39;cultural facility&#39;</span><span class="p">,</span> <span class="s1">&#39;cultural_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;theatre&#39;</span><span class="p">,</span> <span class="s1">&#39;cinema&#39;</span><span class="p">,</span> <span class="s1">&#39;studio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exhibition_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;music_school&#39;</span><span class="p">,</span> <span class="s1">&#39;theater&#39;</span><span class="p">,</span><span class="s1">&#39;castle&#39;</span><span class="p">,</span> <span class="s1">&#39;museum&#39;</span><span class="p">,</span> <span class="s1">&#39;culture&#39;</span><span class="p">]</span>

<span class="n">eating_drinking</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bbq&#39;</span><span class="p">,</span> <span class="s1">&#39;restaurant&#39;</span><span class="p">,</span> <span class="s1">&#39;fast_food&#39;</span><span class="p">,</span> <span class="s1">&#39;cafe&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>  <span class="s1">&#39;pub&#39;</span><span class="p">,</span> <span class="s1">&#39;accommodation, eating and drinking&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ice_cream&#39;</span><span class="p">,</span> <span class="s1">&#39;kitchen&#39;</span><span class="p">,</span> <span class="s1">&#39;food_court&#39;</span><span class="p">,</span> <span class="s1">&#39;cafe;restaurant&#39;</span><span class="p">,</span> <span class="s1">&#39;biergarten&#39;</span><span class="p">]</span>

<span class="n">education_research</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;university&#39;</span><span class="p">,</span> <span class="s1">&#39;research&#39;</span><span class="p">,</span> <span class="s1">&#39;university building&#39;</span><span class="p">,</span> <span class="s1">&#39;education and research&#39;</span><span class="p">,</span> <span class="s1">&#39;research_institute&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;research_institu&#39;</span><span class="p">]</span>

<span class="n">emergency_service</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;fire brigade&#39;</span><span class="p">,</span><span class="s1">&#39;fire_station&#39;</span><span class="p">,</span><span class="s1">&#39;police&#39;</span><span class="p">,</span> <span class="s1">&#39;emergency_service&#39;</span><span class="p">,</span> <span class="s1">&#39;resque_station&#39;</span><span class="p">,</span> <span class="s1">&#39;ranger_station&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;security&#39;</span><span class="p">]</span>

<span class="n">general_education</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;school&#39;</span><span class="p">,</span> <span class="s1">&#39;college&#39;</span><span class="p">,</span> <span class="s1">&#39;kindergarten&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;education and health&#39;</span><span class="p">,</span> <span class="s1">&#39;childcare&#39;</span><span class="p">,</span>
             <span class="s1">&#39;language_school&#39;</span><span class="p">,</span> <span class="s1">&#39;children home&#39;</span><span class="p">,</span>  <span class="s1">&#39;nursery&#39;</span><span class="p">,</span>  <span class="s1">&#39;general education school&#39;</span><span class="p">]</span>

<span class="n">hospitality</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;hotel&#39;</span><span class="p">,</span>  <span class="s1">&#39;hostel&#39;</span><span class="p">,</span> <span class="s1">&#39;guest_house&#39;</span><span class="p">,</span>  <span class="s1">&#39;building for accommodation&#39;</span><span class="p">,</span>  <span class="s1">&#39;hotel, motel, pension&#39;</span><span class="p">,</span>  <span class="s1">&#39;refuge&#39;</span><span class="p">]</span>

<span class="n">industrial</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;industrial&#39;</span><span class="p">,</span> <span class="s1">&#39;factory&#39;</span><span class="p">,</span> <span class="s1">&#39;construction&#39;</span><span class="p">,</span> <span class="s1">&#39;manufacturing and production&#39;</span><span class="p">,</span> <span class="s1">&#39;gasometer&#39;</span><span class="p">,</span> <span class="s1">&#39;workshop&#39;</span><span class="p">,</span>
              <span class="s1">&#39;production building&#39;</span><span class="p">,</span> <span class="s1">&#39;manufacture&#39;</span><span class="p">]</span>

<span class="n">medical_care</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hospital&#39;</span><span class="p">,</span> <span class="s1">&#39;doctors&#39;</span><span class="p">,</span> <span class="s1">&#39;dentist&#39;</span><span class="p">,</span><span class="s1">&#39;clinic&#39;</span><span class="p">,</span><span class="s1">&#39;veterinary&#39;</span><span class="p">,</span> <span class="s1">&#39;medical care&#39;</span><span class="p">,</span> <span class="s1">&#39;nursing_home&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sanatorium, nursing home&#39;</span><span class="p">,</span> <span class="s1">&#39;retirement home&#39;</span><span class="p">,</span> <span class="s1">&#39;healthcare&#39;</span><span class="p">,</span> <span class="s1">&#39;mortuary&#39;</span><span class="p">]</span>

<span class="n">military_detainment</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;general aviation&#39;</span><span class="p">,</span> <span class="s1">&#39;barracks&#39;</span><span class="p">,</span>  <span class="s1">&#39;military&#39;</span><span class="p">,</span> <span class="s1">&#39;penitentiary&#39;</span><span class="p">,</span> <span class="s1">&#39;prison&#39;</span><span class="p">]</span>

<span class="n">other</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;toilets&#39;</span><span class="p">,</span> <span class="s1">&#39;picnic_site&#39;</span><span class="p">,</span><span class="s1">&#39;hut&#39;</span><span class="p">,</span> <span class="s1">&#39;storage_tank&#39;</span><span class="p">,</span> <span class="s1">&#39;canopy&#39;</span><span class="p">,</span><span class="s1">&#39;toilet&#39;</span><span class="p">,</span>  <span class="s1">&#39;bunker, shelter&#39;</span><span class="p">,</span> <span class="s1">&#39;shelter&#39;</span><span class="p">,</span><span class="s1">&#39;warehouse&#39;</span><span class="p">,</span>
         <span class="s1">&#39;converter&#39;</span><span class="p">,</span>    <span class="s1">&#39;garage&#39;</span><span class="p">,</span> <span class="s1">&#39;garages&#39;</span><span class="p">,</span><span class="s1">&#39;parking&#39;</span><span class="p">,</span> <span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="s1">&#39;roof&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;exempt&#39;</span><span class="p">,</span><span class="s1">&#39;exempt 121a&#39;</span><span class="p">,</span> <span class="s1">&#39;bicycle_parking&#39;</span><span class="p">]</span>

<span class="n">public</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;townhall&#39;</span><span class="p">,</span> <span class="s1">&#39;public_building&#39;</span><span class="p">,</span>  <span class="s1">&#39;library&#39;</span><span class="p">,</span><span class="s1">&#39;civic&#39;</span><span class="p">,</span> <span class="s1">&#39;courthouse&#39;</span><span class="p">,</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="s1">&#39;embassy&#39;</span><span class="p">,</span>
          <span class="s1">&#39;public infrastructure&#39;</span><span class="p">,</span> <span class="s1">&#39;community_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;court&#39;</span><span class="p">,</span>  <span class="s1">&#39;district government&#39;</span><span class="p">,</span> <span class="s1">&#39;government&#39;</span><span class="p">,</span>
          <span class="s1">&#39;residential building with public facilities&#39;</span><span class="p">]</span>

<span class="n">religious</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;church&#39;</span><span class="p">,</span> <span class="s1">&#39;place_of_worship&#39;</span><span class="p">,</span><span class="s1">&#39;convent&#39;</span><span class="p">,</span> <span class="s1">&#39;rectory&#39;</span><span class="p">,</span> <span class="s1">&#39;chapel&#39;</span><span class="p">,</span> <span class="s1">&#39;religious building&#39;</span><span class="p">,</span> <span class="s1">&#39;monastery&#39;</span><span class="p">,</span> <span class="s1">&#39;nuns home&#39;</span><span class="p">,</span>
              <span class="s1">&#39;vocational school&#39;</span><span class="p">,</span>  <span class="s1">&#39;cathedral&#39;</span><span class="p">,</span> <span class="s1">&#39;religious buildings&#39;</span><span class="p">]</span>
<span class="n">residential</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;apartments&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span> <span class="s1">&#39;residential&#39;</span><span class="p">,</span><span class="s1">&#39;flats&#39;</span><span class="p">,</span> <span class="s1">&#39;houses&#39;</span><span class="p">,</span> <span class="s1">&#39;building&#39;</span><span class="p">,</span> <span class="s1">&#39;residential land&#39;</span><span class="p">,</span>
               <span class="s1">&#39;residential building&#39;</span><span class="p">,</span> <span class="s1">&#39;student dorm&#39;</span><span class="p">,</span> <span class="s1">&#39;building usage mixed with living&#39;</span><span class="p">,</span> <span class="s1">&#39;house&#39;</span>
              <span class="s1">&#39;exempt&#39;</span><span class="p">,</span> <span class="s1">&#39;apartments 4-6 units&#39;</span><span class="p">,</span> <span class="s1">&#39;apartments 7 units above&#39;</span><span class="p">,</span> <span class="s1">&#39;residential condo unit&#39;</span><span class="p">,</span> <span class="s1">&#39;mixed use res/comm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;residential three family&#39;</span><span class="p">,</span> <span class="s1">&#39;residential two family&#39;</span><span class="p">,</span><span class="s1">&#39;house&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial condo unit&#39;</span><span class="p">,</span> <span class="s1">&#39;condominium master&#39;</span><span class="p">,</span>
               <span class="s1">&#39;condominium parking&#39;</span><span class="p">,</span> <span class="s1">&#39;residential single family&#39;</span><span class="p">]</span>

<span class="n">social</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;social_facility&#39;</span><span class="p">,</span> <span class="s1">&#39;community_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;community buidling&#39;</span><span class="p">,</span> <span class="s1">&#39;dormitory&#39;</span><span class="p">,</span> <span class="s1">&#39;social_centre&#39;</span><span class="p">,</span> <span class="s1">&#39;social serives building&#39;</span><span class="p">,</span>
         <span class="s1">&#39;social services&#39;</span><span class="p">,</span>  <span class="s1">&#39;community hall&#39;</span><span class="p">,</span>  <span class="s1">&#39;commercial social facility&#39;</span><span class="p">,</span>  <span class="s1">&#39;recreational&#39;</span><span class="p">]</span>

<span class="n">sport</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;stadium&#39;</span><span class="p">,</span> <span class="s1">&#39;sport and entertainment&#39;</span><span class="p">,</span> <span class="s1">&#39;sports or exercise facility&#39;</span><span class="p">,</span> <span class="s1">&#39;gym&#39;</span><span class="p">,</span> <span class="s1">&#39;sports building&#39;</span><span class="p">,</span> <span class="s1">&#39;sports hall&#39;</span><span class="p">,</span>
         <span class="s1">&#39;horse riding school&#39;</span><span class="p">,</span>  <span class="s1">&#39;swimming pool&#39;</span><span class="p">,</span>  <span class="s1">&#39;sport hall&#39;</span><span class="p">,</span> <span class="s1">&#39;bowling hall&#39;</span><span class="p">,</span>  <span class="s1">&#39;indoor swimming pool&#39;</span><span class="p">,</span> <span class="s1">&#39;grandstand&#39;</span><span class="p">]</span>

<span class="n">transport</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;transport&#39;</span><span class="p">,</span> <span class="s1">&#39;road transport&#39;</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="s1">&#39;subway_entrance&#39;</span><span class="p">,</span> <span class="s1">&#39;bus_station&#39;</span><span class="p">,</span> <span class="s1">&#39;shipping facility building&#39;</span><span class="p">,</span>
             <span class="s1">&#39;train_station&#39;</span><span class="p">,</span>  <span class="s1">&#39;railway building&#39;</span><span class="p">,</span>  <span class="s1">&#39;railway station and london underground station&#39;</span><span class="p">,</span> <span class="s1">&#39;railway station&#39;</span><span class="p">,</span>
            <span class="s1">&#39;london underground station&#39;</span><span class="p">,</span> <span class="s1">&#39;light rapid transit station&#39;</span><span class="p">,</span> <span class="s1">&#39;light rapid transit station and railway station&#39;</span><span class="p">]</span>

<span class="n">utilities</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gas supply&#39;</span><span class="p">,</span> <span class="s1">&#39;electricity supply&#39;</span><span class="p">,</span> <span class="s1">&#39;electricity substation&#39;</span><span class="p">,</span> <span class="s1">&#39;waste treatment building&#39;</span><span class="p">,</span>
            <span class="s1">&#39;water supply&#39;</span><span class="p">,</span> <span class="s1">&#39;waste water treatment plant&#39;</span><span class="p">,</span> <span class="s1">&#39;smokestack&#39;</span><span class="p">,</span> <span class="s1">&#39;supply systems&#39;</span><span class="p">,</span> <span class="s1">&#39;waste management&#39;</span><span class="p">,</span> <span class="s1">&#39;water works&#39;</span><span class="p">,</span>
              <span class="s1">&#39;heating plant&#39;</span><span class="p">,</span> <span class="s1">&#39;boiler house&#39;</span><span class="p">,</span>  <span class="s1">&#39;telecommunication&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;land_use_raw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obstructions</span><span class="p">[</span><span class="s1">&#39;land_use_raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">adult_entertainment</span><span class="p">,</span> <span class="n">agriculture</span><span class="p">,</span> <span class="n">attractions</span><span class="p">,</span> <span class="n">business_services</span><span class="p">,</span> <span class="n">commercial</span><span class="p">,</span> <span class="n">culture</span><span class="p">,</span> <span class="n">eating_drinking</span><span class="p">,</span>
       <span class="n">education_research</span><span class="p">,</span> <span class="n">emergency_service</span><span class="p">,</span> <span class="n">general_education</span><span class="p">,</span> <span class="n">hospitality</span><span class="p">,</span> <span class="n">industrial</span><span class="p">,</span> <span class="n">medical_care</span><span class="p">,</span> <span class="n">military_detainment</span><span class="p">,</span>
       <span class="n">other</span><span class="p">,</span> <span class="n">public</span><span class="p">,</span> <span class="n">religious</span><span class="p">,</span> <span class="n">residential</span><span class="p">,</span> <span class="n">social</span><span class="p">,</span> <span class="n">sport</span><span class="p">,</span> <span class="n">transport</span><span class="p">,</span> <span class="n">utilities</span><span class="p">]</span>
<span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;adult_entertainment&#39;</span><span class="p">,</span> <span class="s1">&#39;agriculture&#39;</span><span class="p">,</span> <span class="s1">&#39;attractions&#39;</span><span class="p">,</span> <span class="s1">&#39;business_services&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial&#39;</span><span class="p">,</span> <span class="s1">&#39;culture&#39;</span><span class="p">,</span> <span class="s1">&#39;eating_drinking&#39;</span><span class="p">,</span>
       <span class="s1">&#39;education_research&#39;</span><span class="p">,</span> <span class="s1">&#39;emergency_service&#39;</span><span class="p">,</span> <span class="s1">&#39;general_education&#39;</span><span class="p">,</span> <span class="s1">&#39;hospitality&#39;</span><span class="p">,</span> <span class="s1">&#39;industrial&#39;</span><span class="p">,</span> <span class="s1">&#39;medical_care&#39;</span><span class="p">,</span>
           <span class="s1">&#39;military_detainment&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="s1">&#39;religious&#39;</span><span class="p">,</span> <span class="s1">&#39;residential&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">,</span> <span class="s1">&#39;sport&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span><span class="p">,</span> <span class="s1">&#39;utilities&#39;</span><span class="p">]</span>

<span class="n">all_uses</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">categories</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
<span class="n">land_uses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">obstructions</span><span class="o">.</span><span class="n">land_use_raw</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">to_categorise</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">land_uses</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_uses</span><span class="p">]</span>

<span class="c1"># shows existing raw categories to classify</span>
<span class="n">to_categorise</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and finally classify</span>
<span class="n">obstructions</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">classify_land_use</span><span class="p">(</span><span class="n">obstructions</span><span class="p">,</span> <span class="s1">&#39;land_use&#39;</span><span class="p">,</span><span class="s1">&#39;land_use_raw&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="p">,</span> <span class="n">strings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Pragmatic-meaning-computation">
<h3>Pragmatic meaning computation<a class="headerlink" href="#Pragmatic-meaning-computation" title="Link to this heading">#</a></h3>
<p><strong>Computing the pragmatic score and assigning it to ``buildings_gdf``</strong></p>
<p>The pragmatic component is computed on the <code class="docutils literal notranslate"><span class="pre">obstructions</span></code> GeoDataFrame as the measure is based on the adjacent buildings’ land use categories. It is a measure of entropy, or information, for which an unusual land-use category within an area receives higher score. The <code class="docutils literal notranslate"><span class="pre">buffer</span></code> parameter indicates the extension of the area that is used to compute the score of a building, on the basis of its land-use’s frequency.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obstructions</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">pragmatic_score</span><span class="p">(</span><span class="n">obstructions</span><span class="p">,</span> <span class="n">research_radius</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">obstructions</span><span class="p">[[</span><span class="s1">&#39;prag&#39;</span><span class="p">,</span> <span class="s1">&#39;land_use&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingID&#39;</span><span class="p">]],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;buildingID&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>URBAN DMA Categorisation</strong></p>
<p>The land use can also be cagtegorised into 3 categories see <a class="reference external" href="https://journals.sagepub.com/doi/full/10.1177/0042098018819727">https://journals.sagepub.com/doi/full/10.1177/0042098018819727</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buildings</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">visit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;adult_entertainment&#39;</span><span class="p">,</span> <span class="s1">&#39;attractions&#39;</span><span class="p">,</span> <span class="s1">&#39;culture&#39;</span><span class="p">,</span> <span class="s1">&#39;eating_drinking&#39;</span><span class="p">,</span> <span class="s1">&#39;sport&#39;</span><span class="p">,</span> <span class="s1">&#39;religious&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">,</span> <span class="s1">&#39;sport&#39;</span><span class="p">]</span>
<span class="n">work</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;agriculture&#39;</span><span class="p">,</span> <span class="s1">&#39;business_services&#39;</span><span class="p">,</span> <span class="s1">&#39;commercial&#39;</span><span class="p">,</span> <span class="s1">&#39;education_research&#39;</span><span class="p">,</span> <span class="s1">&#39;emergency_service&#39;</span><span class="p">,</span> <span class="s1">&#39;general_education&#39;</span><span class="p">,</span>
        <span class="s1">&#39;industrial&#39;</span><span class="p">,</span><span class="s1">&#39;medical_care&#39;</span><span class="p">,</span> <span class="s1">&#39;military_detainment&#39;</span><span class="p">,</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span><span class="p">,</span><span class="s1">&#39;utilities&#39;</span><span class="p">]</span>
<span class="n">live</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hospitality&#39;</span><span class="p">,</span> <span class="s1">&#39;residential&#39;</span><span class="p">]</span>

<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">visit</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">live</span><span class="p">]</span>
<span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;visit&#39;</span><span class="p">,</span> <span class="s1">&#39;work&#39;</span><span class="p">,</span> <span class="s1">&#39;live&#39;</span><span class="p">]</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">classify_land_use</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="s1">&#39;DMA&#39;</span><span class="p">,</span><span class="s1">&#39;land_use&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="p">,</span> <span class="n">strings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualising</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;gold&#39;</span><span class="p">]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">plot_gdf</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;DMA&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Land use&#39;</span><span class="p">,</span> <span class="n">black_background</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/otherExamples_Landmarks_Local_Files_33_0.png" src="../_images/otherExamples_Landmarks_Local_Files_33_0.png" />
</div>
</div>
</section>
</section>
<section id="Final-scores">
<h2>Final scores<a class="headerlink" href="#Final-scores" title="Link to this heading">#</a></h2>
<section id="Defining-Global-indexes-and-components-weights-and-assigning-the-score">
<h3>Defining Global indexes and components weights and assigning the score<a class="headerlink" href="#Defining-Global-indexes-and-components-weights-and-assigning-the-score" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">global_indexes_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3dvis&#39;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span> <span class="s1">&#39;fac&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;2dvis&#39;</span><span class="p">:</span><span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span> <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">}</span>
<span class="n">global_components_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vScore&#39;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span> <span class="s1">&#39;sScore&#39;</span> <span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;cScore&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span> <span class="s1">&#39;pScore&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">}</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">compute_global_scores</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">global_indexes_weights</span><span class="p">,</span> <span class="n">global_components_weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Define-Local-indexes-and-components-weights">
<h3>Define Local indexes and components weights<a class="headerlink" href="#Define-Local-indexes-and-components-weights" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local_indexes_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3dvis&#39;</span><span class="p">:</span> <span class="mf">0.50</span><span class="p">,</span> <span class="s1">&#39;fac&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.20</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="mf">0.40</span><span class="p">,</span> <span class="s1">&#39;2dvis&#39;</span><span class="p">:</span> <span class="mf">0.00</span><span class="p">,</span> <span class="s1">&#39;neigh&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span> <span class="s1">&#39;road&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">}</span>
<span class="n">local_components_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vScore&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s1">&#39;sScore&#39;</span> <span class="p">:</span> <span class="mf">0.35</span><span class="p">,</span> <span class="s1">&#39;cScore&#39;</span><span class="p">:</span><span class="mf">0.10</span><span class="p">,</span> <span class="s1">&#39;pScore&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">}</span>
<span class="n">rescaling_radius</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># to define the local dimension, choose based on the extent of the case study area</span>
<span class="n">buildings</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">compute_local_scores</span><span class="p">(</span><span class="n">buildings</span><span class="p">,</span> <span class="n">local_indexes_weights</span><span class="p">,</span> <span class="n">local_components_weights</span><span class="p">,</span> <span class="n">rescaling_radius</span> <span class="o">=</span>
                                    <span class="n">rescaling_radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Visualisation-of-the-Components">
<h3>Visualisation of the Components<a class="headerlink" href="#Visualisation-of-the-Components" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sScore_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;vScore_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;pScore&#39;</span><span class="p">,</span> <span class="s1">&#39;cScore&#39;</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Structural Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Visual Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Pragmatic Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Cultural Score&#39;</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">plot_grid_gdf_columns</span><span class="p">(</span><span class="n">gdf</span> <span class="o">=</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">,</span> <span class="n">titles</span> <span class="o">=</span> <span class="n">titles</span><span class="p">,</span> <span class="n">black_background</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
                  <span class="n">scheme</span> <span class="o">=</span> <span class="s1">&#39;fisher_jenks&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/otherExamples_Landmarks_Local_Files_40_0.png" src="../_images/otherExamples_Landmarks_Local_Files_40_0.png" />
</div>
</div>
</section>
<section id="Visualisation-of-the-Global-and-Local-Landmark-Scores">
<h3>Visualisation of the Global and Local Landmark Scores<a class="headerlink" href="#Visualisation-of-the-Global-and-Local-Landmark-Scores" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gScore_sc&#39;</span><span class="p">,</span> <span class="s1">&#39;lScore_sc&#39;</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Global Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Local Score&#39;</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">plot_grid_gdf_columns</span><span class="p">(</span><span class="n">gdf</span> <span class="o">=</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">,</span> <span class="n">titles</span> <span class="o">=</span> <span class="n">titles</span><span class="p">,</span> <span class="n">black_background</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
                  <span class="n">scheme</span> <span class="o">=</span> <span class="s1">&#39;fisher_jenks&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/otherExamples_Landmarks_Local_Files_42_0.png" src="../_images/otherExamples_Landmarks_Local_Files_42_0.png" />
</div>
</div>
<p><strong>Exporting</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sight_lines.to_file(output_path+&#39;_sight_lines.gpkg&#39;, driver=&#39;GPKG&#39;)</span>
<span class="n">buildings</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">output_path</span><span class="o">+</span><span class="s1">&#39;_landmarks.gpkg&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;GPKG&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Preparation">Preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Obstructions">Obstructions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Buildings">Buildings</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Structural-component">Structural component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Visual-component">Visual component</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Sight-Lines-Construction">Sight Lines Construction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Cultural-component">Cultural component</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Pragmatic-component">Pragmatic component</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Pragmatic-meaning-computation">Pragmatic meaning computation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Final-scores">Final scores</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Defining-Global-indexes-and-components-weights-and-assigning-the-score">Defining Global indexes and components weights and assigning the score</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Define-Local-indexes-and-components-weights">Define Local indexes and components weights</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Visualisation-of-the-Components">Visualisation of the Components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Visualisation-of-the-Global-and-Local-Landmark-Scores">Visualisation of the Global and Local Landmark Scores</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/otherExamples/Landmarks_Local_Files.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Gabriele Filomena.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>